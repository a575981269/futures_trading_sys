# SimNow 模拟环境使用指南

## 账户信息

- **经纪公司代码**: 9999（统一）
- **默认APPID**: simnow_client_test
- **默认认证码**: 0000000000000000（16个0）
- **终端认证**: 默认开启，程序化用户可以选择不开终端认证接入

## 配置步骤

### 1. 设置密码

SimNow 的交易密码是注册时设置的密码。请在 `.env` 文件中设置：

```env
CTP_PASSWORD=你的SimNow交易密码
```

### 2. 服务器地址

SimNow 提供两种环境：

#### 环境一：网上开户环境（默认）

提供三组服务器（看穿式前置，使用监控中心生产秘钥），默认使用第一组：

**第一组（默认）:**
- **行情服务器**: `tcp://182.254.243.31:30011`
- **交易服务器**: `tcp://182.254.243.31:30001`

**第二组:**
- **行情服务器**: `tcp://182.254.243.31:30012`
- **交易服务器**: `tcp://182.254.243.31:30002`

**第三组:**
- **行情服务器**: `tcp://182.254.243.31:30013`
- **交易服务器**: `tcp://182.254.243.31:30003`

#### 环境二：7x24 环境（CTP API 测试专用）

**注意：** 第二套环境仅服务于 CTP API 开发爱好者，仅为用户提供 CTP API 测试需求，不提供结算等其它服务。

- **行情服务器**: `tcp://182.254.243.31:40011`
- **交易服务器**: `tcp://182.254.243.31:40001`

**7x24 环境说明：**
- 新注册用户需要等到第三个交易日才能使用
- 账户、资金、持仓与第一套环境上一个交易日保持一致
- **交易时间**：
  - 交易日：16:00 ～ 次日 09:00
  - 非交易日：16:00 ～ 次日 12:00
- 建议通过商业终端进行模拟交易的用户使用第一套环境

可在 `.env` 文件中配置使用哪组服务器。

### 3. 运行测试

```bash
# 测试连接配置
python test_simnow.py

# 只测试行情接口
python test_simnow.py market

# 只测试交易接口
python test_simnow.py trading

# 全部测试
python test_simnow.py all
```

## 重要提示

### ⚠️ 当前状态

当前代码为**框架代码**，实际的 CTP 连接功能需要实现。系统提供了接口定义，但具体的 CTP API 调用需要：

1. **使用 CTP 封装库**（推荐）:
   - `vnpy-ctp`: VeighNa 框架的 CTP 接口
   - `pyctp`: Python 封装的 CTP 接口
   - 其他第三方封装库

2. **直接调用 CTP API**:
   - 需要 CTP 的 C++ 动态库文件
   - 使用 `ctypes` 调用 C++ 接口

### 📝 实现建议

#### 方案一：使用 vnpy-ctp（推荐）

```bash
pip install vnpy-ctp
```

然后在 `market_data/ctp_realtime.py` 和 `trading/ctp_trader.py` 中实现连接逻辑。

#### 方案二：使用 pyctp

```bash
pip install pyctp
```

#### 方案三：使用其他 CTP 封装库

根据你选择的库，实现相应的连接逻辑。

## SimNow 使用说明

### 1. 访问 SimNow 官网

**推荐浏览器：** 请使用 Firefox、Chrome 或 Edge 浏览器访问 [SimNow 官网](http://www.simnow.com.cn/)

在官网可以：
- 查看账户信息
- 查看服务器状态
- 查看使用文档
- 查询投资者代码
- 重置密码
- 入金操作

### 2. 注册和登录

**注册流程：**
1. 在 SimNow 官网进行用户注册
2. 注册成功后获得投资者号（6位）
3. 注册信息会以短信方式发送

**登录交易：**
1. 从 SimNow 官网下载交易终端
2. 输入投资者ID和注册时设置的密码
3. 选择线路（终端会提供多条链路）
4. 首次登录需要修改密码

**密码重置：**
- 可以通过网站首页重置密码功能
- 或通过 SimNow 客服电话 4009206816 进行修改

### 3. 账户信息

- **初始资金**: 两千万
- **入金**: 支持入金，每日最多三次
- **清算时间**: 每日 16:00 至 19:00 为系统清算时间
- **新账户入金**: 在每日 16:00 至 19:00 注册的账户，将在下一交易节（19:00 以后）入金
- **同时登录**: 每个账户允许同时 4 个 session 登录（系统压力大时可能调整为 2 个或 1 个）

### 4. 交易时间

SimNow 模拟环境的交易时间与实际生产环境保持一致。

#### 日盘交易时间

| 交易所 | 集合竞价 | 连续交易 | 品种类别 |
|--------|----------|----------|----------|
| 上海期货交易所 | 8:55-9:00 | 上午：09:00-10:15 10:30-11:30<br>下午：13:30-15:00 | 所有品种 |
| 上海国际能源交易中心 | 8:55-9:00 | 上午：09:00-10:15 10:30-11:30<br>下午：13:30-15:00 | 所有品种 |
| 大连商品交易所 | 8:55-9:00 | 上午：09:00-10:15 10:30-11:30<br>下午：13:30-15:00 | 所有品种 |
| 郑州商品交易所 | 8:55-9:00 | 上午：09:00-10:15 10:30-11:30<br>下午：13:30-15:00 | 所有品种 |
| 广州期货交易所 | 8:55-9:00 | 上午：09:00-10:15 10:30-11:30<br>下午：13:30-15:00 | 所有品种 |
| 中国金融期货交易所 | 9:25-9:30 | 上午：09:30-11:30<br>下午：13:00-15:15 | 所有品种 |

#### 夜盘交易时间

| 交易所 | 集合竞价 | 连续交易 | 品种类别 |
|--------|----------|----------|----------|
| 上海期货交易所 | 20:55-21:00 | 21:00-次日02:30 | 黄金、白银、黄金期权、白银期权 |
| 上海期货交易所 | 20:55-21:00 | 21:00-次日01:00 | 铜、铝、锌、铅、氧化铝、不锈钢、锡、镍、铜期权、铝期权、锌期权、铅期权、氧化铝期权、锡期权、镍期权、铸造铝合金期货、铸造铝合金期权 |
| 上海期货交易所 | 20:55-21:00 | 21:00-23:00 | 螺纹钢、热轧卷板、石油沥青、天然橡胶、丁二烯橡胶、纸浆、燃料油、螺纹钢期权、天胶期权、丁二烯橡胶期权 |
| 上海国际能源中心 | 20:55-21:00 | 21:00-次日02:30 | 原油、原油期权 |
| 上海国际能源中心 | 20:55-21:00 | 21:00-次日01:00 | 国际铜 |
| 上海国际能源中心 | 20:55-21:00 | 21:00-23:00 | 低硫燃料油、20号胶 |
| 郑州商品交易所 | 20:55-21:00 | 21:00-23:00 | 相关期货品种、白糖期权、纯碱期权、菜籽粕期权、PTA期权、甲醇期权、玻璃期权 |
| 大连商品交易所 | 20:55-21:00 | 21:00-23:00 | 相关期货品种、玉米期权、铁矿石期权、棕榈油期权、豆粕期权、苯乙烯期权 |
| 广州期货交易所 | 20:55-21:00 | 21:00-次日01:00 | 多晶硅期权 |

## 常见问题

### Q: 连接失败怎么办？

A: 检查以下几点：
1. 密码是否正确（在 `.env` 文件中设置）
2. 网络连接是否正常
3. SimNow 服务器是否正常（查看官网状态）
4. 是否在交易时间内
5. 是否超过了同时登录限制（每个账户最多 4 个 session）

### Q: 如何查看账户信息？

A: 
- 登录 SimNow 官网查看（推荐使用 Firefox、Chrome 或 Edge 浏览器）
- 使用交易接口的 `query_account()` 方法
- 在 SimNow 网站个人中心查看
- 使用网站提供的投资者代码查询功能

### Q: 可以使用哪些合约？

A: SimNow 支持六所所有期货品种以及期权品种：
- **期货**: 上期所 (SHFE)、大商所 (DCE)、郑商所 (CZCE)、中金所 (CFFEX)、能源中心 (INE)、广期所 (GFEX)
- **期权**: 
  - 上期所期权（全部）
  - 能源中心期权（全部）
  - 中金所期权（全部）
  - 广期所期权（全部）
  - 郑商所期权（部分）
  - 大商所期权（部分）

### Q: 如何获取合约代码？

A: 合约代码格式为：品种代码 + 年月
- 例如：`rb2501` (螺纹钢 2025年1月)
- 例如：`cu2501` (铜 2025年1月)

### Q: 我可以开多个模拟账户吗？

A: 可以。模拟账户与手机号绑定，可以使用多个手机号分别开户。

### Q: 每个账户可以同时开几个终端？

A: 目前每个账户允许同时 4 个 session 登录。在系统压力激增的情况下可能会调整为 2 个或 1 个 session。

### Q: 我注册成功之后为什么没有初始的 2000 万资金？

A: 在每日 16:00 至 19:00 为系统清算时间，该时间段所注册的账户将在下一交易节入金，即 19:00 以后会有 2000 万资金。

### Q: 我 2000 万资金不够用，如何可以添加资金？

A: 投资者可以使用 SimNow 网站提供的入金功能来满足需求（入金有次数和额度限制，每日限额三次）。

### Q: 我注册了 SimNow 为什么收不到短信？

A: 短信发送有时因为信号问题会存在延时，如果持续很久收不到短信可以通过 4009206816 电话咨询客服人员。

### Q: 我注册成功之后如何知道自己的交易账号？

A: 
- 成功注册开户之后，会将信息以短信的方式发送给开户人
- SimNow 网站同时提供投资者代码查询功能
- 也可以登录后在个人中心查看

### Q: 我是量化交易投资者，如何登录 SimNow？

A: 可以接入网上开户与 7x24 环境。接入地址见产品与服务页。BrokerID 统一为 9999，默认的 APPID 为 simnow_client_test，认证码为 0000000000000000（16个0），默认开启终端认证，程序化用户可以选择不开终端认证接入。

### Q: SimNow 可以开通实盘交易吗？

A: 不可以。SimNow 只提供模拟交易，只是使用了实盘行情，并非实盘交易。如果要进行实盘交易需要去期货公司进行实盘开户。

### Q: 我可以多次参加仿真大奖赛吗？

A: 目前 SimNow 仿真大赛皆是与期货公司或者金融机构联合举办，报名参赛信息需咨询相关金融机构。SimNow 官网也会不定期提示即将以及开始的比赛。可以同时或者多次参加不同的仿真大赛。

## 下一步

1. ✅ 配置 `.env` 文件中的密码
2. ⏳ 实现 CTP 连接逻辑（使用 vnpy-ctp 或其他库）
3. ⏳ 测试行情订阅
4. ⏳ 测试下单功能
5. ⏳ 集成到策略中

## 技术支持

- SimNow 官网: http://www.simnow.com.cn/
- SimNow 客服: 查看官网联系方式
- 系统文档: 查看 `ARCHITECTURE.md`

